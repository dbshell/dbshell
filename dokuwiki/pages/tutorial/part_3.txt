====== Part 3 – export all tables, for-each cycle ======

In this article, I will show how to export all tables in database in CSV files. Code doing this looks like following:

<code xml>	
<?xml version="1.0" encoding="utf-8" ?>
<ForEach
xmlns="http://schemas.dbshell.com/core"
Connection="sqlserver://MultipleActiveResultSets=True;Data Source=localhost\SQLEXPRESS;Integrated Security=SSPI;Initial Catalog=Chinook"
Source="{Tables}"
Property="Table"
>
<CopyTable Source="{Table ${Table.Name}}" Target="{File ${Table.Name}.csv}" />
</ForEach>
</code>

Root element is [[http://dbshell.com/docs/?topic=html/T_DbShell_Core_ForEach.htm|ForEach]] definition. In Source property, there is source of items to iterate. We are using [[http://dbshell.com/docs/?topic=html/T_DbShell_Core_TablesExtension.htm|TablesExtension]] class for getting table list from current connection. CopyTable operation is repeated for each table in source database. For each cycle Property “Table” is set to table object currently processing.

We are also using also expression syntax ${Expression} – this syntax evaluates expression in braces. So Table.Name returns name of current table.
